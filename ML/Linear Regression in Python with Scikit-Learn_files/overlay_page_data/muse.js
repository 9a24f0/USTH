/* [MUSE_MUSE_BUNDLE]  Thursday, June 27th, 2019, 3:25:45 PM XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  */
 !function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=20)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFRAME_NAMESPACE="paypal-offers",t.PAYPAL_NAMESPACE="paypal",t.DEFAULT_MOBILE_VARIANT="bubble",t.DEFAULT_MOBILE_FLOW="credit",t.ONE_TOUCH_MOBILE_FLOW="one-touch",t.CART_RECOVERY_FRAME_ID="__cr",t.FLOW="flow",t.DESKTOP="desktop",t.MOBILE="mobile",t.VARIANT="variant",t.MOBILE_FLOW="mobileFlow",t.MOBILE_VARIANT="mobileVariant",t.MERCHANT_COUNTRY="merchantCountry",t.SLIDE_UP="slide-up",t.SLIDE_LEFT="slide-left",t.BUBBLE="bubble",t.MODAL="modal",t.MODAL_EXPERIMENT="modal-experiment",t.MINI_SLIDE_UP="mini-slide-up",t.TOAST="toast",t.CART_RECOVERY="cart-recovery",t.CART_RECOVERY_EXPERIMENT="cart-recovery-experiment",t.ONE_TOUCH="one-touch",t.VENMO="venmo",t.OFFER_REMINDERS="offer-reminders",t.COUPON_CODES="coupon-codes",t.PURCHASE_PROTECTION="purchase-protection",t.RETURN_SHIPPING="return-shipping",t.CREDIT="credit",t.US="US",t.GB="GB",t.DE="DE",t.ES="ES",t.IT="IT",t.FR="FR",t.AU="AU",t.HK="HK",t.SG="SG",t.CN="CN",t.C2="C2",t.UK="UK",t.TRUE="true",t.FALSE="false",t.ALL="*",t.UNKNOWN="N/A",t.MUSE_MODAL_CLASS="__muse_modal",t.DEFAULT_COOKIE_AGE_IN_DAYS=3},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.helpers=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=r(0),a=r(3),u=n(a),s=r(5),c=n(s),f=r(12),l=r(2),d=n(l),p=void 0,m=t.helpers={_getScrollHandler:function(e){var t=document.getElementById(i.IFRAME_NAMESPACE+"--iframe-"+e).contentWindow,r=!1,n=void 0;return function(){r||(r=!0,d.default.postRobot.send(t,i.IFRAME_NAMESPACE+":scrollEvent")),n&&clearTimeout(n),n=setTimeout(function(){r=!1},1e3)}}},v=function(e){e&&e.parentNode.removeChild(e)},w=function(e){window.PAYPAL&&window.PAYPAL.muse&&window.PAYPAL.muse.timeouts&&(clearTimeout(window.PAYPAL.muse.timeouts[e]),delete window.PAYPAL.muse.timeouts[e])},y=function(e){var t=void 0;if(window.removeEventListener("scroll",p),e){var r=document.getElementById(i.IFRAME_NAMESPACE+"--iframe-"+e);return v(r),t=document.querySelectorAll("style."+i.IFRAME_NAMESPACE+"--styles-"+e),t&&Array.prototype.slice.call(t).forEach(function(e){return e.parentNode.removeChild(e)}),void w(e)}(t=document.querySelectorAll('style[class^="'+i.IFRAME_NAMESPACE+'--styles-"]'))&&Array.prototype.slice.call(t).forEach(function(e){return e.parentNode.removeChild(e)});var n=document.querySelectorAll('iframe[id^="'+i.IFRAME_NAMESPACE+'--iframe-"]');n&&Array.prototype.slice.call(n).forEach(function(e){v(e),w(e.getAttribute("id"))}),window.PAYPAL&&window.PAYPAL.muse&&window.PAYPAL.muse.timeouts&&(Object.keys(window.PAYPAL.muse.timeouts).forEach(function(e){clearTimeout(window.PAYPAL.muse.timeouts[e])}),delete window.PAYPAL.muse.timeouts)},h=function(e){return function(){return y(e)}},g=function(e){p=m._getScrollHandler(e),window.addEventListener("scroll",p)},_=function(e){return function(){var t=e||{},r=t.dismissCookieAge;if(0!==r){var n=o({},(0,f.getCookieOptions)(),{expires:r||1});c.default.set(i.IFRAME_NAMESPACE+"--dismissOffer","true",n)}}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.limit)return!1;var t=e.limit,r=e.flow||"",n=i.IFRAME_NAMESPACE+"--view-count"+(r?"-"+r:""),a=o({},(0,f.getCookieOptions)(),{expires:1}),u=parseInt(c.default.get(n),10)||0;return!(u<t&&(c.default.set(n,++u,a),1))},S=function(e){return function(t){var r=document.getElementById(i.IFRAME_NAMESPACE+"--iframe-"+e);r&&(r.className=t)}},O=function(e){var t=document.body.className,r=document.documentElement.className;document.body.className=(t+" "+e).trim(),document.documentElement.className=(r+" "+e).trim()},b=function(e){var t=document.body.className,r=document.documentElement.className;document.body.className=t.replace(e,"").trim(),document.documentElement.className=r.replace(e,"").trim()},A=function(e){return function(t){var r=document.createElement("style");r.setAttribute("type","text/css"),r.setAttribute("class",i.IFRAME_NAMESPACE+"--styles-"+e),r.appendChild(document.createTextNode(t)),document.head.appendChild(r)}},P=function(e){if(e&&e.track){var t={feature:"offer"},r=o({},e.track.overrides,t),n={fltp:e.track.overrides&&e.track.overrides.subfeature1};e.track.overrides&&e.track.overrides.sub_component&&(n.sub_component=e.track.overrides.sub_component),u.default.track(e.track.eventType,r,n)}},T=function(e){if(e&&window.fpti){var t=e.xe||"",r=e.xt||"",n=e.qc||"",o=e.qt||"";window.fpti.xe=window.fpti.xe?window.fpti.xe+=","+t:t,window.fpti.xt=window.fpti.xt?window.fpti.xt+=","+r:r,window.fpti.qc=window.fpti.qc?window.fpti.qc+=","+n:n,window.fpti.qt=window.fpti.qt?window.fpti.qt+=","+o:o}},C=function(e){e&&e.tracking&&T(e.tracking)},N=function(e){window.localStorage.setItem(i.PAYPAL_NAMESPACE+"--"+e.name,e.payload)},M=function(e){window[e.name]=e.value},R=function(e){u.default.log(e)};t.default={clean:y,getCleanListener:h,attachScrollListener:g,generateSetDismissCookie:_,shouldCap:E,getModifyClassListener:S,getCreateStyleTagListener:A,track:P,flowDataFetched:C,saveToLocalStorage:N,log:R,addClassToDocument:O,removeClassFromDocument:b,setWindowVariable:M}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(4),i=n(o),a=r(16),u=n(a);u.default.CONFIG.LOG_LEVEL=i.default.getPostRobotLogLevel(),e.exports={postRobot:u.default}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=n(o),a=r(9),u=n(a),s=r(1),c=n(s),f=r(8),l=n(f),d=r(10);t.default={init:i.default,track:u.default,log:function(){},clean:c.default.clean,showExperience:l.default.render,updateExperience:d.updateExperience.update}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.getPostRobotLogLevel=function(){return"error"},o=t.getFptiServerUrl=function(){return"//t.paypal.com/ts"},i=t.getMuseServerUrl=function(){return"https://www.paypal.com"},a=t.getGeoLocationUrl=function(){return"https://www.paypalobjects.com/muse/noop.js"},u=t.getTargetingUrl=function(){return"https://www.paypal.com/targeting"},s=t.getAuthServerUrl=function(){return"https://www.paypal.com"};t.default={getFptiServerUrl:o,getPostRobotLogLevel:n,getMuseServerUrl:i,getGeoLocationUrl:a,getTargetingUrl:u,getAuthServerUrl:s}},function(e,t,r){var n,o;!function(i){if(n=i,void 0!==(o="function"==typeof n?n.call(t,r,t,e):n)&&(e.exports=o),!0,e.exports=i(),!!0){var a=window.Cookies,u=window.Cookies=i();u.noConflict=function(){return window.Cookies=a,u}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function t(r){function n(t,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if(i=e({path:"/"},n.defaults,i),"number"==typeof i.expires){var u=new Date;u.setMilliseconds(u.getMilliseconds()+864e5*i.expires),i.expires=u}i.expires=i.expires?i.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}o=r.write?r.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape);var s="";for(var c in i)i[c]&&(s+="; "+c,!0!==i[c]&&(s+="="+i[c]));return document.cookie=t+"="+o+s}t||(a={});for(var f=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;d<f.length;d++){var p=f[d].split("="),m=p.slice(1).join("=");this.json||'"'!==m.charAt(0)||(m=m.slice(1,-1));try{var v=p[0].replace(l,decodeURIComponent);if(m=r.read?r.read(m,v):r(m,v)||m.replace(l,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(e){}if(t===v){a=m;break}t||(a[v]=m)}catch(e){}}return a}}return n.set=n,n.get=function(e){return n.call(n,e)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(t,r){n(t,"",e(r,{expires:-1}))},n.withConverter=t,n}return t(function(){})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=function(e,t){if("function"!=typeof o.default[e])throw new Error("`"+e+"` is not a valid command.");o.default[e].apply(null,t)},a=function(){if("undefined"!=typeof window&&"string"==typeof window.PaypalOffersObject){var e=window.PAYPAL||{};window.PAYPAL=e,e.muse=e.muse||{};var t=window.PaypalOffersObject,r=window[t].q||[];window[t].pptmTrack&&(o.default.track=window[t].pptmTrack),window[t].log&&(o.default.log=window[t].log);for(var n=0;n<r.length;n++)if(r[n].length&&"showOffer"===r[n][0])return delete e.muse,delete window.PaypalOffersObject,void delete window[t];for(;r.length;){var a=r.shift(),u=a[0],s=Array.prototype.slice.call(a,1);i(u,s)}window[t]=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(e,r)}}};t.default=a,a()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.init=function(e){if("string"!=typeof e)throw new Error("actions.init() called without valid `propertyId`");if(void 0===window.PAYPAL||void 0===window.PAYPAL.muse)throw new Error("actions.init() expects `window.PAYPAL.muse` to be defined");window.PAYPAL.muse.propertyId=e};t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=r(1),a=n(i),u=r(0),s=r(5),c=n(s),f=r(13),l=n(f),d=r(11),p=r(2),m=n(p),v={_getConnectionStartedListener:function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.default.track({track:{eventType:"pageView",overrides:o({flavor:"connectionStarted"},t.overrides)}}),t.attachScrollListener&&a.default.attachScrollListener(e),window.PAYPAL&&window.PAYPAL.muse&&window.PAYPAL.muse.timeouts&&(clearTimeout(window.PAYPAL.muse.timeouts[e]),delete window.PAYPAL.muse.timeouts[e])}},_getFrameSource:function(e,t,r,n){var o=e+"?frameId="+t+(r?"&propertyId="+r:"")+((0,l.default)()?"&ppdebug=1":"");for(var i in n)"function"!=typeof n[i]&&(o+="&"+i+"="+n[i]);return o},_getIFrame:function(e,t,r,n){var o=document.createElement("iframe"),i=v._getFrameSource(e,t,r,n);return o.style.zIndex="999999999999999999999999999999999999999999999",o.style.display="none",o.id=u.IFRAME_NAMESPACE+"--iframe-"+t,o.src=i,o.dataset&&(o.dataset.merchant=r),o},_attachListeners:function(e,t){var r=a.default.getCleanListener,n=a.default.getModifyClassListener,o=a.default.generateSetDismissCookie,i=a.default.getCreateStyleTagListener,s=a.default.track,c=a.default.flowDataFetched,f=a.default.log,l=a.default.saveToLocalStorage,d=a.default.addClassToDocument,p=a.default.removeClassFromDocument,w=a.default.setWindowVariable,y={clean:r(e),modifyClass:n(e),createStyleTag:i(e),setDismissCookie:o(t),connectionStarted:v._getConnectionStartedListener(e),track:function(e){s(e),t.handleEvents&&t.handleEvents(e)},getBrowserDimensions:function(e){try{var t=document.innerWidth?document.innerWidth:document.body.clientWidth,r=document.innerHeight?document.innerHeight:document.body.clientHeight;e(null,{height:r,width:t})}catch(t){e(t,null)}},flowDataFetched:c,log:f,saveToLocalStorage:l,addClassToDocument:d,removeClassFromDocument:p,setWindowVariable:w};Object.keys(y).forEach(function(t){m.default.postRobot.on(u.IFRAME_NAMESPACE+":"+e+":"+t,function(e){var r=e.data;y[t](r)})});var h=v._setSelfDestructTimer(25e3,y.clean);window.PAYPAL.muse.timeouts||(window.PAYPAL.muse.timeouts={}),window.PAYPAL.muse.timeouts[e]=h},_attachPublishers:function(e,t){var r=function(r){return m.default.postRobot.send(t,u.IFRAME_NAMESPACE+":"+e+":"+r).catch(function(e){})};window.PAYPAL.muse.show=function(e){return r("show")},window.PAYPAL.muse.hide=function(e){return r("hide")}},_render:function(e,t,r){var n=(0,d.generateFrameId)(r);v._attachListeners(n,r);var o=v._getIFrame(e,n,window.PAYPAL.muse.propertyId,r),i="string"==typeof t?document.querySelector(t):t;i&&i.appendChild&&(v._attachPublishers(n,o),i.appendChild(o))},_setSelfDestructTimer:function(e,t){return setTimeout(function(){(0,l.default)(),t()},e)},render:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&t&&window.PAYPAL&&window.PAYPAL.muse&&"true"!==c.default.get(u.IFRAME_NAMESPACE+"--dismissOffer")&&(r.limit&&a.default.shouldCap(r)||v._render(e,t,r))}};t.default=v},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=r(4),a=r(14),u=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(e){return Object.keys(e).reduce(function(t,r){return e[r]||!1===e[r]||0===e[r]?o({},t,n({},r,e[r])):t},{})},c=function(e){return o({identifier:"musenodeweb",website:"muse",feature:"third-party",s:"ci",fltp:"",subfeature1:"",subfeature2:"",sub_component:"",pageType:"",userType:"",flavor:"",es:"",testVariant:"",link:"",erpg:"",flag_consume:"",correlation_id:""},e)},f=function(e){return{pgrp:[e.website,e.feature,e.subfeature1,e.subfeature2,e.pageType].join(":"),page:[e.website,e.feature,e.subfeature1,e.subfeature2,e.pageType,e.userType,e.flavor,e.testVariant].join(":"),tsrce:e.identifier,comp:e.identifier,sub_component:e.sub_component,s:e.s,item:e.item,fltp:e.fltp,sbfl:e.sbfl,link:e.link,es:e.flavor,cust:e.cust,mrid:e.mrid,erpg:e.erpg,error_code:e.error_code,xe:e.xe,xt:e.xt,qe:e.qe,qt:e.qt,flag_consume:e.flag_consume,correlation_id:e.correlation_id}},l=["pageView","click","serverCall"],d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(0,i.getFptiServerUrl)();if(~l.indexOf(e)&&n){var a=f(c(t)),d=o({},a,{e:"pageView"===e?"im":"cl"},"click"===e?{pglk:a.pgrp+"|"+a.link,pgln:a.page+"|"+a.link}:{},{t:Date.now(),g:(new Date).getTimezoneOffset()},r);u.default.send(n,s(d))}};e.exports=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateExperience=void 0;var o=r(0),i=r(2),a=n(i),u=r(1),s=n(u),c=t.updateExperience={update:function(e){a.default.postRobot.send(document.getElementById(o.IFRAME_NAMESPACE+"--iframe-"+o.CART_RECOVERY_FRAME_ID),o.IFRAME_NAMESPACE+":listenToUpdates",e).catch(function(e){s.default.clean(o.CART_RECOVERY_FRAME_ID)})}};t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateFrameId=t.uuidv4Wrapper=void 0;var n=r(19),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(0),a=t.uuidv4Wrapper={uuidv4:o.default};t.generateFrameId=function(e){if(e){if(e.iframeId)return e.iframeId;if(e.flow===i.CART_RECOVERY||e.flow===i.CART_RECOVERY_EXPERIMENT)return i.CART_RECOVERY_FRAME_ID}return a.uuidv4()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.helpers={_getDocumentHostname:function(){return document.location.hostname},_extractSecondAndTopLevelDomain:function(e){if(!e)return!1;var t=e,r=e.split("."),n=r.length;if(n<2)return!1;var o=r[n-2],i=r[n-1];return!(!o.length||!i.length)&&(n>2&&(t=o+"."+i,2===o.length&&2===i.length&&(t=r[n-3]+"."+t)),t)}},o=t.getCookieOptions=function(){var e=n._getDocumentHostname(),t=n._extractSecondAndTopLevelDomain(e);return t?{domain:t}:{}};t.default={getCookieOptions:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(window.__ppdebug)return!0===window.__ppdebug;var e=!1;try{e=!!~window.location.href.indexOf("ppdebug=1")}catch(e){}return e}},function(e,t,r){"use strict";var n=function(e,t){if(e&&t){var r=[];for(var n in t)t.hasOwnProperty(n)&&r.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));r=r.join("&"),(new window.Image).src=e+"?"+r}};e.exports={send:n}},function(e,t,r){!function(t,r){e.exports=function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=26)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(10);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,r){"use strict";function n(e){var t=e.location;if(!t)throw new Error("Can not read window location");var r=t.protocol;if(!r)throw new Error("Can not read window protocol");if(r===q.FILE_PROTOCOL)return"file://";var n=t.host;if(!n)throw new Error("Can not read window host");return r+"//"+n}function o(e){e=e||window;var t=n(e);return t&&e.mockDomain&&0===e.mockDomain.indexOf(q.MOCK_PROTOCOL)?e.mockDomain:t}function i(e){try{if(!e.location.href)return!0;if("about:blank"===e.location.href)return!0}catch(e){}return!1}function a(e){try{var t=Object.getOwnPropertyDescriptor(e,"location");if(t&&!1===t.enumerable)return!1}catch(e){}try{if(i(e))return!0;if(n(e)===n(window))return!0}catch(e){}return!1}function u(e){if(!a(e))return!1;try{if(i(e))return!0;if(o(window)===o(e))return!0}catch(e){}return!1}function s(e){if(e)try{if(e.parent&&e.parent!==e)return e.parent}catch(e){return}}function c(e){if(e&&!s(e))try{return e.opener}catch(e){return}}function f(e){var t=[];try{for(;e.parent!==e;)t.push(e.parent),e=e.parent}catch(e){}return t}function l(e,t){if(!e||!t)return!1;var r=s(t);return r?r===e:-1!==f(t).indexOf(e)}function d(e){var t=[],r=void 0;try{r=e.frames}catch(t){r=e}var n=void 0;try{n=r.length}catch(e){}if(0===n)return t;if(n){for(var o=0;o<n;o++){var i=void 0;try{i=r[o]}catch(e){continue}t.push(i)}return t}for(var a=0;a<100;a++){var u=void 0;try{u=r[a]}catch(e){return t}if(!u)return t;t.push(u)}return t}function p(e){for(var t=[],r=d(e),n=Array.isArray(r),o=0,r=n?r:r[Symbol.iterator]();;){var i;if(n){if(o>=r.length)break;i=r[o++]}else{if(o=r.next(),o.done)break;i=o.value}var a=i;t.push(a);for(var u=p(a),s=Array.isArray(u),c=0,u=s?u:u[Symbol.iterator]();;){var f;if(s){if(c>=u.length)break;f=u[c++]}else{if(c=u.next(),c.done)break;f=c.value}var l=f;t.push(l)}}return t}function m(e){if(e){try{if(e.top)return e.top}catch(e){}if(s(e)===e)return e;try{if(l(window,e)&&window.top)return window.top}catch(e){}try{if(l(e,window)&&window.top)return window.top}catch(e){}for(var t=p(e),r=Array.isArray(t),n=0,t=r?t:t[Symbol.iterator]();;){var o;if(r){if(n>=t.length)break;o=t[n++]}else{if(n=t.next(),n.done)break;o=n.value}var i=o;try{if(i.top)return i.top}catch(e){}if(s(i)===i)return i}}}function v(e){var t=m(e);return p(t).concat(t)}function w(e){return e===m(e)}function y(e){if(!e.contentWindow)return!0;if(!e.parentNode)return!0;var t=e.ownerDocument;return!(!t||!t.body||t.body.contains(e))}function h(e,t){for(var r=0;r<e.length;r++)try{if(e[r]===t)return r}catch(e){}return-1}function g(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(e===window)return!1}catch(e){return!0}try{if(!e)return!0}catch(e){return!0}try{if(e.closed)return!0}catch(e){return!e||e.message!==Z}if(t&&u(e))try{if(e.mockclosed)return!0}catch(e){}try{if(!e.parent||!e.top)return!0}catch(e){}try{(0,B.noop)(e===e)}catch(e){return!0}var r=h(H,e);if(-1!==r){var n=V[r];if(n&&y(n))return!0}return!1}function _(){for(var e=0;e<V.length;e++)y(V[e])&&(V.splice(e,1),H.splice(e,1));for(var t=0;t<H.length;t++)g(H[t])&&(V.splice(t,1),H.splice(t,1))}function E(e){if(_(),e&&e.contentWindow)try{H.push(e.contentWindow),V.push(e)}catch(e){}}function S(e){return e=e||window,e.navigator.mockUserAgent||e.navigator.userAgent}function O(e,t){for(var r=d(e),n=r,o=Array.isArray(n),i=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if(i=n.next(),i.done)break;a=i.value}var s=a;try{if(u(s)&&s.name===t&&-1!==r.indexOf(s))return s}catch(e){}}try{if(-1!==r.indexOf(e.frames[t]))return e.frames[t]}catch(e){}try{if(-1!==r.indexOf(e[t]))return e[t]}catch(e){}}function b(e,t){var r=O(e,t);if(r)return r;for(var n=d(e),o=Array.isArray(n),i=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if(i=n.next(),i.done)break;a=i.value}var u=a,s=b(u,t);if(s)return s}}function A(e,t){var r=void 0;return(r=O(e,t))?r:b(m(e)||e,t)}function P(e,t){var r=s(t);if(r)return r===e;for(var n=d(e),o=Array.isArray(n),i=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if(i=n.next(),i.done)break;a=i.value}if(a===t)return!0}return!1}function T(e,t){return e===c(t)}function C(e){return e=e||window,c(e)||s(e)||void 0}function N(e){for(var t=[],r=e;r;)(r=C(r))&&t.push(r);return t}function M(e,t){var r=C(t);if(r)return r===e;if(t===e)return!1;if(m(t)===t)return!1;for(var n=d(e),o=Array.isArray(n),i=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if(i=n.next(),i.done)break;a=i.value}if(a===t)return!0}return!1}function R(){return Boolean(c(window))}function L(){return Boolean(s(window))}function I(){return Boolean(!L()&&!R())}function j(e,t){for(var r=e,n=Array.isArray(r),o=0,r=n?r:r[Symbol.iterator]();;){var i;if(n){if(o>=r.length)break;i=r[o++]}else{if(o=r.next(),o.done)break;i=o.value}for(var a=i,u=t,s=Array.isArray(u),c=0,u=s?u:u[Symbol.iterator]();;){var f;if(s){if(c>=u.length)break;f=u[c++]}else{if(c=u.next(),c.done)break;f=c.value}if(a===f)return!0}}return!1}function k(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=0,r=e;r;)(r=s(r))&&(t+=1);return t}function D(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e,n=0;n<t;n++){if(!r)return;r=s(r)}return r}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return D(e,k(e)-t)}function W(e,t){var r=m(e)||e,n=m(t)||t;try{if(r&&n)return r===n}catch(e){}var o=v(e),i=v(t);if(j(o,i))return!0;var a=c(r),u=c(n);return!(a&&j(v(a),i)||(u&&j(v(u),o),1))}function F(e,t){if("string"==typeof e){if("string"==typeof t)return e===q.WILDCARD||t===e;if((0,B.isRegex)(t))return!1;if(Array.isArray(t))return!1}return(0,B.isRegex)(e)?(0,B.isRegex)(t)?e.toString()===t.toString():!Array.isArray(t)&&Boolean(t.match(e)):!!Array.isArray(e)&&(Array.isArray(t)?JSON.stringify(e)===JSON.stringify(t):!(0,B.isRegex)(t)&&e.some(function(e){return F(e,t)}))}function G(e){var t=void 0;return e.match(/^(https?|mock|file):\/\//)?(t=e,t=t.split("/").slice(0,3).join("/")):o()}function U(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,o=void 0;return function i(){if(g(e))return o&&clearTimeout(o),t();n<=0?clearTimeout(o):(n-=r,o=setTimeout(i,r))}(),{cancel:function(){o&&clearTimeout(o)}}}function Y(e){try{if(e===window)return!0}catch(e){if(e&&e.message===Z)return!0}try{if("[object Window]"===Object.prototype.toString.call(e))return!0}catch(e){if(e&&e.message===Z)return!0}try{if(window.Window&&e instanceof window.Window)return!0}catch(e){if(e&&e.message===Z)return!0}try{if(e&&e.self===e)return!0}catch(e){if(e&&e.message===Z)return!0}try{if(e&&e.parent===e)return!0}catch(e){if(e&&e.message===Z)return!0}try{if(e&&e.top===e)return!0}catch(e){if(e&&e.message===Z)return!0}try{(0,B.noop)(e===e)}catch(e){return!0}try{(0,B.noop)(e&&e.__cross_domain_utils_window_check__)}catch(e){return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.getActualDomain=n,t.getDomain=o,t.isBlankDomain=i,t.isActuallySameDomain=a,t.isSameDomain=u,t.getParent=s,t.getOpener=c,t.getParents=f,t.isAncestorParent=l,t.getFrames=d,t.getAllChildFrames=p,t.getTop=m,t.getAllFramesInWindow=v,t.isTop=w,t.isFrameWindowClosed=y,t.isWindowClosed=g,t.linkFrameWindow=E,t.getUserAgent=S,t.getFrameByName=O,t.findChildFrameByName=b,t.findFrameByName=A,t.isParent=P,t.isOpener=T,t.getAncestor=C,t.getAncestors=N,t.isAncestor=M,t.isPopup=R,t.isIframe=L,t.isFullpage=I,t.getDistanceFromTop=k,t.getNthParent=D,t.getNthParentFromTop=x,t.isSameTopWindow=W,t.matchDomain=F,t.getDomainFromUrl=G,t.onCloseWindow=U,t.isWindow=Y;var B=r(17),q={MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",WILDCARD:"*"},Z="Call was rejected by callee.\r\n",H=[],V=[]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19);Object.defineProperty(t,"ZalgoPromise",{enumerable:!0,get:function(){return n.ZalgoPromise}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.global=void 0;var n=r(0);(t.global=window[n.CONSTANTS.WINDOW_PROPS.POSTROBOT]=window[n.CONSTANTS.WINDOW_PROPS.POSTROBOT]||{}).registerSelf=function(){}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(9);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(28);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(27);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(23);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(12);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(11);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t,r){"use strict";function n(e){if(!e)return"<unknown error: "+Object.prototype.toString.call(e)+">";if("string"==typeof e)return e;if(e instanceof Error){var t=e&&e.stack,r=e&&e.message;if(t&&r)return-1!==t.indexOf(r)?t:r+"\n"+t;if(t)return t;if(r)return r}return"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e)}function o(){}function i(e,t,r){return e.addEventListener?e.addEventListener(t,r):e.attachEvent("on"+t,r),{cancel:function(){e.removeEventListener?e.removeEventListener(t,r):e.detachEvent("on"+t,r)}}}function a(){var e="0123456789abcdef";return"xxxxxxxxxx".replace(/./g,function(){return e.charAt(Math.floor(Math.random()*e.length))})}function u(e,t){for(var r=0;r<e.length;r++)t(e[r],r)}function s(e,t){for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)}function c(e,t){Array.isArray(e)?u(e,t):"object"===(void 0===e?"undefined":w(e))&&null!==e&&s(e,t)}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(r>=100)throw new Error("Self-referential object passed, or object contained too many layers");var n=void 0;if("object"!==(void 0===e?"undefined":w(e))||null===e||Array.isArray(e)){if(!Array.isArray(e))throw new Error("Invalid type: "+(void 0===e?"undefined":w(e)));n=[]}else n={};return c(e,function(e,o){var i=t(e,o);void 0!==i?n[o]=i:"object"===(void 0===e?"undefined":w(e))&&null!==e?n[o]=f(e,t,r+1):n[o]=e}),n}function l(e,t){function r(){n=setTimeout(r,t),e.call()}var n=void 0;return n=setTimeout(r,t),{cancel:function(){clearTimeout(n)}}}function d(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function p(){return(0,h.isPopup)()?g.CONSTANTS.WINDOW_TYPES.POPUP:(0,h.isIframe)()?g.CONSTANTS.WINDOW_TYPES.IFRAME:g.CONSTANTS.WINDOW_TYPES.FULLPAGE}function m(e,t,r){var n=void 0,o=void 0;try{if("{}"!==JSON.stringify({})&&(n=Object.prototype.toJSON,delete Object.prototype.toJSON),"{}"!==JSON.stringify({}))throw new Error("Can not correctly serialize JSON objects");if("[]"!==JSON.stringify([])&&(o=Array.prototype.toJSON,delete Array.prototype.toJSON),"[]"!==JSON.stringify([]))throw new Error("Can not correctly serialize JSON objects")}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}var i=JSON.stringify.call(this,e,t,r);try{n&&(Object.prototype.toJSON=n),o&&(Array.prototype.toJSON=o)}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}return i}function v(e){return JSON.parse(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.weakMapMemoize=t.once=void 0;var w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.stringifyError=n,t.noop=o,t.addEventListener=i,t.uniqueID=a,t.eachArray=u,t.eachObject=s,t.each=c,t.replaceObject=f,t.safeInterval=l,t.isRegex=d,t.getWindowType=p,t.jsonStringify=m,t.jsonParse=v;var y=r(5),h=r(1),g=r(0);t.once=function(e){if(!e)return e;var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}},t.weakMapMemoize=function(e){var t=new y.WeakMap;return function(r){var n=t.get(r);return void 0!==n?n:(n=e.call(this,r),void 0!==n&&t.set(r,n),n)}}},function(e,t,r){"use strict";function n(){c.global.initialized||((0,s.listenForMessages)(),(0,u.initOnReady)(),(0,u.listenForMethods)()),c.global.initialized=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.Promise=t.cleanUpWindow=void 0;var o=r(21);Object.defineProperty(t,"cleanUpWindow",{enumerable:!0,get:function(){return o.cleanUpWindow}}),t.init=n;var i=r(31);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(2);Object.defineProperty(t,"Promise",{enumerable:!0,get:function(){return a.ZalgoPromise}});var u=r(4),s=r(6),c=r(3);n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(7),i=r(0),a=["debug","info","warn","error"];Function.prototype.bind&&window.console&&"object"===n(console.log)&&["log","info","warn","error"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call);var u=t.log={clearLogs:function(){if(window.console&&window.console.clear&&window.console.clear(),i.CONFIG.LOG_TO_PAGE){var e=document.getElementById("postRobotLogs");e&&e.parentNode&&e.parentNode.removeChild(e)}},writeToPage:function(e,t){setTimeout(function(){var r=document.getElementById("postRobotLogs");r||(r=document.createElement("div"),r.id="postRobotLogs",r.style.cssText="width: 800px; font-family: monospace; white-space: pre-wrap;",document.body&&document.body.appendChild(r));var n=document.createElement("div"),i=(new Date).toString().split(" ")[4],a=Array.prototype.slice.call(t).map(function(e){if("string"==typeof e)return e;if(!e)return Object.prototype.toString.call(e);var t=void 0;try{t=(0,o.jsonStringify)(e,null,2)}catch(e){t="[object]"}return"\n\n"+t+"\n\n"}).join(" "),u=i+" "+e+" "+a;n.innerHTML=u;var s={log:"#ddd",warn:"orange",error:"red",info:"blue",debug:"#aaa"}[e];n.style.cssText="margin-top: 10px; color: "+s+";",r.childNodes.length?r.insertBefore(n,r.childNodes[0]):r.appendChild(n)})},logLevel:function(e,t){setTimeout(function(){try{var r=window.LOG_LEVEL||i.CONFIG.LOG_LEVEL;if(a.indexOf(e)<a.indexOf(r))return;if(t=Array.prototype.slice.call(t),t.unshift(""+window.location.host+window.location.pathname),t.unshift("::"),t.unshift(""+(0,o.getWindowType)().toLowerCase()),t.unshift("[post-robot]"),i.CONFIG.LOG_TO_PAGE&&u.writeToPage(e,t),!window.console)return;if(window.console[e]||(e="log"),!window.console[e])return;window.console[e].apply(window.console,t)}catch(e){}},1)},debug:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];u.logLevel("debug",t)},info:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];u.logLevel("info",t)},warn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];u.logLevel("warn",t)},error:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];u.logLevel("error",t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.CONSTANTS={POST_MESSAGE_TYPE:{REQUEST:"postrobot_message_request",RESPONSE:"postrobot_message_response",ACK:"postrobot_message_ack"},POST_MESSAGE_ACK:{SUCCESS:"success",ERROR:"error"},POST_MESSAGE_NAMES:{METHOD:"postrobot_method",READY:"postrobot_ready",OPEN_TUNNEL:"postrobot_open_tunnel"},WINDOW_TYPES:{FULLPAGE:"fullpage",POPUP:"popup",IFRAME:"iframe"},WINDOW_PROPS:{POSTROBOT:"__postRobot__"},SERIALIZATION_TYPES:{METHOD:"postrobot_method",ERROR:"postrobot_error",PROMISE:"postrobot_promise",ZALGO_PROMISE:"postrobot_zalgo_promise",REGEX:"regex"},SEND_STRATEGIES:{POST_MESSAGE:"postrobot_post_message",BRIDGE:"postrobot_bridge",GLOBAL:"postrobot_global"},MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",BRIDGE_NAME_PREFIX:"__postrobot_bridge__",POSTROBOT_PROXY:"__postrobot_proxy__",WILDCARD:"*"};t.POST_MESSAGE_NAMES_LIST=Object.keys(n.POST_MESSAGE_NAMES).map(function(e){return n.POST_MESSAGE_NAMES[e]})},function(e,t,r){"use strict";function n(){l.global.responseListeners={},l.global.requestListeners={}}function o(e,t){l.global.responseListeners[e]=t}function i(e){return l.global.responseListeners[e]}function a(e){delete l.global.responseListeners[e]}function u(e){var t=e.name,r=e.win,n=e.domain;if(r===p.CONSTANTS.WILDCARD&&(r=null),n===p.CONSTANTS.WILDCARD&&(n=null),!t)throw new Error("Name required to get request listener");var o=l.global.requestListeners[t];if(o)for(var i=[r,l.global.WINDOW_WILDCARD],a=0;a<i.length;a++){var u=i[a],s=u&&o.get(u);if(s){if(n&&"string"==typeof n){if(s[n])return s[n];if(s[m])for(var c=s[m],d=Array.isArray(c),v=0,c=d?c:c[Symbol.iterator]();;){var w;if(d){if(v>=c.length)break;w=c[v++]}else{if(v=c.next(),v.done)break;w=v.value}var y=w,h=y.regex,g=y.listener;if((0,f.matchDomain)(h,n))return g}}if(s[p.CONSTANTS.WILDCARD])return s[p.CONSTANTS.WILDCARD]}}}function s(e,t){var r=e.name,n=e.win,o=e.domain;if(!r||"string"!=typeof r)throw new Error("Name required to add request listener");if(Array.isArray(n)){for(var i=[],a=n,f=Array.isArray(a),v=0,a=f?a:a[Symbol.iterator]();;){var w;if(f){if(v>=a.length)break;w=a[v++]}else{if(v=a.next(),v.done)break;w=v.value}var y=w;i.push(s({name:r,domain:o,win:y},t))}return{cancel:function(){for(var e=i,t=Array.isArray(e),r=0,e=t?e:e[Symbol.iterator]();;){var n;if(t){if(r>=e.length)break;n=e[r++]}else{if(r=e.next(),r.done)break;n=r.value}n.cancel()}}}}if(Array.isArray(o)){for(var h=[],g=o,_=Array.isArray(g),E=0,g=_?g:g[Symbol.iterator]();;){var S;if(_){if(E>=g.length)break;S=g[E++]}else{if(E=g.next(),E.done)break;S=E.value}var O=S;h.push(s({name:r,win:n,domain:O},t))}return{cancel:function(){for(var e=h,t=Array.isArray(e),r=0,e=t?e:e[Symbol.iterator]();;){var n;if(t){if(r>=e.length)break;n=e[r++]}else{if(r=e.next(),r.done)break;n=r.value}n.cancel()}}}}var b=u({name:r,win:n,domain:o});if(n&&n!==p.CONSTANTS.WILDCARD||(n=l.global.WINDOW_WILDCARD),o=o||p.CONSTANTS.WILDCARD,b)throw n&&o?new Error("Request listener already exists for "+r+" on domain "+o.toString()+" for specified window"):n?new Error("Request listener already exists for "+r+" for specified window"):o?new Error("Request listener already exists for "+r+" on domain "+o.toString()):new Error("Request listener already exists for "+r);var A=l.global.requestListeners,P=A[r];P||(P=new c.WeakMap,A[r]=P);var T=P.get(n);T||(T={},P.set(n,T));var C=o.toString(),N=T[m],M=void 0;return(0,d.isRegex)(o)?(N||(N=[],T[m]=N),M={regex:o,listener:t},N.push(M)):T[C]=t,{cancel:function(){T&&(delete T[C],n&&0===Object.keys(T).length&&P.delete(n),M&&N.splice(N.indexOf(M,1)))}}}Object.defineProperty(t,"__esModule",{value:!0}),t.resetListeners=n,t.addResponseListener=o,t.getResponseListener=i,t.deleteResponseListener=a,t.getRequestListener=u,t.addRequestListener=s,r(2);var c=r(5),f=r(1),l=r(3),d=r(4),p=r(0);l.global.responseListeners=l.global.responseListeners||{},l.global.requestListeners=l.global.requestListeners||{},l.global.WINDOW_WILDCARD=l.global.WINDOW_WILDCARD||new function(){};var m="__domain_regex__"},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(0,f.uniqueID)(),o=(0,f.getWindowType)(),i=(0,u.getDomain)(window);return a({},t,r,{sourceDomain:i,id:t.id||n,windowType:o})}function i(e,t,r){return s.ZalgoPromise.try(function(){t=o(e,t,{data:(0,f.serializeMethods)(e,r,t.data),domain:r});var i=void 0;if(i=-1!==c.POST_MESSAGE_NAMES_LIST.indexOf(t.name)||t.type===c.CONSTANTS.POST_MESSAGE_TYPE.ACK?"debug":"error"===t.ack?"error":"info",f.log.logLevel(i,["\n\n\t","#send",t.type.replace(/^postrobot_message_/,""),"::",t.name,"::",r||c.CONSTANTS.WILDCARD,"\n\n",t]),e===window)throw new Error("Attemping to send message to self");if((0,u.isWindowClosed)(e))throw new Error("Window is closed");f.log.debug("Running send message strategies",t);var a=[],d=(0,f.jsonStringify)(n({},c.CONSTANTS.WINDOW_PROPS.POSTROBOT,t),null,2);return s.ZalgoPromise.map(Object.keys(l.SEND_MESSAGE_STRATEGIES),function(t){return s.ZalgoPromise.try(function(){if(!c.CONFIG.ALLOWED_POST_MESSAGE_METHODS[t])throw new Error("Strategy disallowed: "+t);return l.SEND_MESSAGE_STRATEGIES[t](e,d,r)}).then(function(){return a.push(t+": success"),!0},function(e){return a.push(t+": "+(0,f.stringifyError)(e)+"\n"),!1})}).then(function(e){var r=e.some(Boolean),n=t.type+" "+t.name+" "+(r?"success":"error")+":\n  - "+a.join("\n  - ")+"\n";if(f.log.debug(n),!r)throw new Error(n)})})}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.sendMessage=i;var u=r(1),s=r(2),c=r(0),f=r(4),l=r(25)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16);Object.defineProperty(t,"WeakMap",{enumerable:!0,get:function(){return n.CrossDomainSafeWeakMap}})},function(e,t,r){"use strict";function n(){if(!window.WeakMap)return!1;if(!window.Object.freeze)return!1;try{var e=new window.WeakMap,t={};return window.Object.freeze(t),e.set(t,"__testvalue__"),"__testvalue__"===e.get(t)}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.hasNativeWeakMap=n},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<e.length;r++)try{if(e[r]===t)return r}catch(e){}return-1}function o(){}Object.defineProperty(t,"__esModule",{value:!0}),t.safeIndexOf=n,t.noop=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CrossDomainSafeWeakMap=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),a=r(14),u=r(15),s=Object.defineProperty,c=Date.now()%1e9;t.CrossDomainSafeWeakMap=function(){function e(){if(n(this,e),c+=1,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__"+c,(0,a.hasNativeWeakMap)())try{this.weakmap=new window.WeakMap}catch(e){}this.keys=[],this.values=[]}return o(e,[{key:"_cleanupClosedWindows",value:function(){for(var e=this.weakmap,t=this.keys,r=0;r<t.length;r++){var n=t[r];if((0,i.isWindow)(n)&&(0,i.isWindowClosed)(n)){if(e)try{e.delete(n)}catch(e){}t.splice(r,1),this.values.splice(r,1),r-=1}}}},{key:"isSafeToReadWrite",value:function(e){if((0,i.isWindow)(e))return!1;try{(0,u.noop)(e&&e.self),(0,u.noop)(e&&e[this.name])}catch(e){return!1}return!0}},{key:"set",value:function(e,t){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{r.set(e,t)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var n=this.name,o=e[n];o&&o[0]===e?o[1]=t:s(e,n,{value:[e,t],writable:!0})}else{this._cleanupClosedWindows();var i=this.keys,a=this.values,c=(0,u.safeIndexOf)(i,e);-1===c?(i.push(e),a.push(t)):a[c]=t}}},{key:"get",value:function(e){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{if(t.has(e))return t.get(e)}catch(e){delete this.weakmap}if(!this.isSafeToReadWrite(e)){this._cleanupClosedWindows();var r=this.keys,n=(0,u.safeIndexOf)(r,e);if(-1===n)return;return this.values[n]}var o=e[this.name];if(o&&o[0]===e)return o[1]}},{key:"delete",value:function(e){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{t.delete(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var r=e[this.name];r&&r[0]===e&&(r[0]=r[1]=void 0)}else{this._cleanupClosedWindows();var n=this.keys,o=(0,u.safeIndexOf)(n,e);-1!==o&&(n.splice(o,1),this.values.splice(o,1))}}},{key:"has",value:function(e){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{return t.has(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var r=e[this.name];return!(!r||r[0]!==e)}return this._cleanupClosedWindows(),-1!==(0,u.safeIndexOf)(this.keys,e)}}]),e}()},function(e,t,r){"use strict";function n(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function o(){}Object.defineProperty(t,"__esModule",{value:!0}),t.isRegex=n,t.noop=o},function(e,t,r){"use strict";function n(e){if(-1===a.indexOf(e)){a.push(e),setTimeout(function(){throw e},1);for(var t=0;t<i.length;t++)i[t](e)}}function o(e){return i.push(e),{cancel:function(){i.splice(i.indexOf(e),1)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchPossiblyUnhandledError=n,t.onPossiblyUnhandledException=o;var i=[],a=[]},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ZalgoPromise=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(20),a=r(18),u=window.__zalgopromise__=window.__zalgopromise__||{flushPromises:[],activeCount:0},s=function(){function e(t){var r=this;if(n(this,e),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],t){var o=void 0,i=void 0,a=!1,u=!1,s=!1;try{t(function(e){s?r.resolve(e):(a=!0,o=e)},function(e){s?r.reject(e):(u=!0,i=e)})}catch(e){return void this.reject(e)}s=!0,a?this.resolve(o):u&&this.reject(i)}}return o(e,[{key:"resolve",value:function(e){if(this.resolved||this.rejected)return this;if((0,i.isPromise)(e))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=e,this.dispatch(),this}},{key:"reject",value:function(e){var t=this;if(this.resolved||this.rejected)return this;if((0,i.isPromise)(e))throw new Error("Can not reject promise with another promise");if(!e){var r=e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e);e=new Error("Expected reject to be called with Error, got "+r)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout(function(){t.errorHandled||(0,a.dispatchPossiblyUnhandledError)(e)},1),this.dispatch(),this}},{key:"asyncReject",value:function(e){this.errorHandled=!0,this.reject(e)}},{key:"dispatch",value:function(){var t=this,r=this.dispatching,n=this.resolved,o=this.rejected,a=this.handlers;if(!r&&(n||o)){this.dispatching=!0,u.activeCount+=1;for(var s=0;s<a.length;s++)!function(r){var u=a[r],s=u.onSuccess,c=u.onError,f=u.promise,l=void 0;if(n)try{l=s?s(t.value):t.value}catch(e){return f.reject(e),"continue"}else if(o){if(!c)return f.reject(t.error),"continue";try{l=c(t.error)}catch(e){return f.reject(e),"continue"}}l instanceof e&&(l.resolved||l.rejected)?(l.resolved?f.resolve(l.value):f.reject(l.error),l.errorHandled=!0):(0,i.isPromise)(l)?l instanceof e&&(l.resolved||l.rejected)?l.resolved?f.resolve(l.value):f.reject(l.error):l.then(function(e){f.resolve(e)},function(e){f.reject(e)}):f.resolve(l)}(s);a.length=0,this.dispatching=!1,u.activeCount-=1,0===u.activeCount&&e.flushQueue()}}},{key:"then",value:function(t,r){if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.then expected a function for success handler");if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for error handler");var n=new e;return this.handlers.push({promise:n,onSuccess:t,onError:r}),this.errorHandled=!0,this.dispatch(),n}},{key:"catch",value:function(e){return this.then(void 0,e)}},{key:"finally",value:function(t){return this.then(function(r){return e.try(t).then(function(){return r})},function(r){return e.try(t).then(function(){throw r})})}},{key:"timeout",value:function(e,t){var r=this;if(this.resolved||this.rejected)return this;var n=setTimeout(function(){r.resolved||r.rejected||r.reject(t||new Error("Promise timed out after "+e+"ms"))},e);return this.then(function(e){return clearTimeout(n),e})}},{key:"toPromise",value:function(){if(!window.Promise)throw new Error("Could not find window.Promise");return window.Promise.resolve(this)}}],[{key:"resolve",value:function(t){return t instanceof e?t:(0,i.isPromise)(t)?new e(function(e,r){return t.then(e,r)}):(new e).resolve(t)}},{key:"reject",value:function(t){return(new e).reject(t)}},{key:"all",value:function(t){var r=new e,n=t.length,o=[];if(!n)return r.resolve(o),r;for(var a=0;a<t.length;a++)!function(a){var u=t[a];if(u instanceof e){if(u.resolved)return o[a]=u.value,n-=1,"continue"}else if(!(0,i.isPromise)(u))return o[a]=u,n-=1,"continue";e.resolve(u).then(function(e){o[a]=e,0==(n-=1)&&r.resolve(o)},function(e){r.reject(e)})}(a);return 0===n&&r.resolve(o),r}},{key:"map",value:function(t,r){var n=new e,o=t.length,i=[];if(!o)return n.resolve(i),n;for(var a=0;a<t.length;a++)!function(a){e.try(function(){return r(t[a])}).then(function(e){i[a]=e,0==(o-=1)&&n.resolve(i)},function(e){n.reject(e)})}(a);return n}},{key:"onPossiblyUnhandledException",value:function(e){return(0,a.onPossiblyUnhandledException)(e)}},{key:"try",value:function(t,r,n){var o=void 0;try{o=t.apply(r,n||[])}catch(t){return e.reject(t)}return e.resolve(o)}},{key:"delay",value:function(t){return new e(function(e){setTimeout(e,t)})}},{key:"hash",value:function(t){var r={},n=[];for(var o in t)!function(o){t.hasOwnProperty(o)&&n.push(e.resolve(t[o]).then(function(e){r[o]=e}))}(o);return e.all(n).then(function(){return r})}},{key:"isPromise",value:function(t){return!!(t&&t instanceof e)||(0,i.isPromise)(t)}},{key:"flush",value:function(){var t=new e;return u.flushPromises.push(t),0===u.activeCount&&e.flushQueue(),t}},{key:"flushQueue",value:function(){var e=u.flushPromises;u.flushPromises=[];for(var t=e,r=Array.isArray(t),n=0,t=r?t:t[Symbol.iterator]();;){var o;if(r){if(n>=t.length)break;o=t[n++]}else{if(n=t.next(),n.done)break;o=n.value}o.resolve()}}}]),e}();t.ZalgoPromise=s},function(e,t,r){"use strict";function n(e){try{if(!e)return!1;if(window.Promise&&e instanceof window.Promise)return!0;if(window.Window&&e instanceof window.Window)return!1;if(window.constructor&&e instanceof window.constructor)return!1;if(o){var t=o.call(e);if("[object Window]"===t||"[object global]"===t||"[object DOMWindow]"===t)return!1}if("function"==typeof e.then)return!0}catch(e){return!1}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=n;var o={}.toString},function(e,t,r){"use strict";function n(e){var t=o.global.requestPromises.get(e);if(t)for(var r=t,n=Array.isArray(r),i=0,r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if(i=r.next(),i.done)break;a=i.value}var u=a;u.reject(new Error("No response from window - cleaned up"))}o.global.popupWindowsByWin&&o.global.popupWindowsByWin.delete(e),o.global.remoteWindows&&o.global.remoteWindows.delete(e),o.global.requestPromises.delete(e),o.global.methods.delete(e),o.global.readyPromises.delete(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.cleanUpWindow=n;var o=r(3)},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.CONFIG=void 0;var o,i=r(10),a=t.CONFIG={ALLOW_POSTMESSAGE_POPUP:!0,LOG_LEVEL:"info",BRIDGE_TIMEOUT:5e3,ACK_TIMEOUT:1e3,RES_TIMEOUT:1/0,LOG_TO_PAGE:!1,ALLOWED_POST_MESSAGE_METHODS:(o={},n(o,i.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE,!0),n(o,i.CONSTANTS.SEND_STRATEGIES.BRIDGE,!0),n(o,i.CONSTANTS.SEND_STRATEGIES.GLOBAL,!0),o)};0===window.location.href.indexOf(i.CONSTANTS.FILE_PROTOCOL)&&(a.ALLOW_POSTMESSAGE_POPUP=!0)},function(e,t,r){"use strict";function n(e){var t=void 0;try{t=(0,f.jsonParse)(e)}catch(e){return}if(t&&"object"===(void 0===t?"undefined":u(t))&&null!==t&&(t=t[c.CONSTANTS.WINDOW_PROPS.POSTROBOT])&&"object"===(void 0===t?"undefined":u(t))&&null!==t&&t.type&&"string"==typeof t.type&&d.RECEIVE_MESSAGE_TYPES[t.type])return t}function o(e){if(!window||window.closed)throw new Error("Message recieved in closed window");try{if(!e.source)return}catch(e){return}var t=e.source,r=e.origin,o=e.data,i=n(o);if(i){if(!i.sourceDomain||"string"!=typeof i.sourceDomain)throw new Error("Expected message to have sourceDomain");if(0!==i.sourceDomain.indexOf(c.CONSTANTS.MOCK_PROTOCOL)&&0!==i.sourceDomain.indexOf(c.CONSTANTS.FILE_PROTOCOL)||(r=i.sourceDomain),-1===l.global.receivedMessages.indexOf(i.id)){l.global.receivedMessages.push(i.id);var a=void 0;if(a=-1!==c.POST_MESSAGE_NAMES_LIST.indexOf(i.name)||i.type===c.CONSTANTS.POST_MESSAGE_TYPE.ACK?"debug":"error"===i.ack?"error":"info",f.log.logLevel(a,["\n\n\t","#receive",i.type.replace(/^postrobot_message_/,""),"::",i.name,"::",r,"\n\n",i]),(0,s.isWindowClosed)(t))return void f.log.debug("Source window is closed - can not send "+i.type+" "+i.name);i.data&&(i.data=(0,f.deserializeMethods)(t,r,i.data)),d.RECEIVE_MESSAGE_TYPES[i.type](t,r,i)}}}function i(e){try{e.source}catch(e){return}o({source:e.source||e.sourceElement,origin:e.origin||e.originalEvent&&e.originalEvent.origin,data:e.data})}function a(){(0,f.addEventListener)(window,"message",i)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.receiveMessage=o,t.messageListener=i,t.listenForMessages=a;var s=r(1),c=r(0),f=r(4),l=r(3),d=r(24);l.global.receivedMessages=l.global.receivedMessages||[]},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.RECEIVE_MESSAGE_TYPES=void 0;var o,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=r(2),u=r(1),s=r(0),c=r(4),f=r(12),l=r(11);t.RECEIVE_MESSAGE_TYPES=(o={},n(o,s.CONSTANTS.POST_MESSAGE_TYPE.ACK,function(e,t,r){var n=(0,l.getResponseListener)(r.hash);if(!n)throw new Error("No handler found for post message ack for message: "+r.name+" from "+t+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,u.matchDomain)(n.domain,t))throw new Error("Ack origin "+t+" does not match domain "+n.domain.toString());n.ack=!0}),n(o,s.CONSTANTS.POST_MESSAGE_TYPE.REQUEST,function(e,t,r){function n(n){return r.fireAndForget||(0,u.isWindowClosed)(e)?a.ZalgoPromise.resolve():(0,f.sendMessage)(e,i({target:r.originalSource,hash:r.hash,name:r.name},n),t)}var o=(0,l.getRequestListener)({name:r.name,win:e,domain:t});return a.ZalgoPromise.all([n({type:s.CONSTANTS.POST_MESSAGE_TYPE.ACK}),a.ZalgoPromise.try(function(){if(!o)throw new Error("No handler found for post message: "+r.name+" from "+t+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,u.matchDomain)(o.domain,t))throw new Error("Request origin "+t+" does not match domain "+o.domain.toString());var n=r.data;return o.handler({source:e,origin:t,data:n})}).then(function(e){return n({type:s.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,ack:s.CONSTANTS.POST_MESSAGE_ACK.SUCCESS,data:e})},function(e){var t=(0,c.stringifyError)(e).replace(/^Error: /,"");return n({type:s.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,ack:s.CONSTANTS.POST_MESSAGE_ACK.ERROR,error:t})})]).then(c.noop).catch(function(e){if(o&&o.handleError)return o.handleError(e);c.log.error((0,c.stringifyError)(e))})}),n(o,s.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,function(e,t,r){var n=(0,l.getResponseListener)(r.hash);if(!n)throw new Error("No handler found for post message response for message: "+r.name+" from "+t+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,u.matchDomain)(n.domain,t))throw new Error("Response origin "+t+" does not match domain "+n.domain);if((0,l.deleteResponseListener)(r.hash),r.ack===s.CONSTANTS.POST_MESSAGE_ACK.ERROR)return n.respond(new Error(r.error),null);if(r.ack===s.CONSTANTS.POST_MESSAGE_ACK.SUCCESS){var o=r.data||r.response;return n.respond(null,{source:e,origin:t,data:o})}}),o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SEND_MESSAGE_STRATEGIES=void 0;var n=r(1),o=r(0);(t.SEND_MESSAGE_STRATEGIES={})[o.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE]=function(e,t,r){var i=void 0;i=Array.isArray(r)?r:r?[r]:[o.CONSTANTS.WILDCARD],i=i.map(function(t){if(0===t.indexOf(o.CONSTANTS.MOCK_PROTOCOL)){if(window.location.protocol===o.CONSTANTS.FILE_PROTOCOL)return o.CONSTANTS.WILDCARD;if(!(0,n.isActuallySameDomain)(e))throw new Error("Attempting to send messsage to mock domain "+t+", but window is actually cross-domain");return(0,n.getActualDomain)(e)}return 0===t.indexOf(o.CONSTANTS.FILE_PROTOCOL)?o.CONSTANTS.WILDCARD:t}),i.forEach(function(r){return e.postMessage(t,r)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.default=o},function(e,t,r){"use strict";function n(){(0,c.on)(s.CONSTANTS.POST_MESSAGE_NAMES.READY,{domain:s.CONSTANTS.WILDCARD},function(e){var t=e.source,r=l.global.readyPromises.get(t);r?r.resolve(e):(r=(new u.ZalgoPromise).resolve(e),l.global.readyPromises.set(t,r))});var e=(0,a.getAncestor)();e&&(0,c.send)(e,s.CONSTANTS.POST_MESSAGE_NAMES.READY,{},{domain:s.CONSTANTS.WILDCARD,timeout:1/0}).catch(function(e){f.log.debug((0,d.stringifyError)(e))})}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Window",n=l.global.readyPromises.get(e);return n||(n=new u.ZalgoPromise,l.global.readyPromises.set(e,n),setTimeout(function(){return n.reject(new Error(r+" did not load after "+t+"ms"))},t),n)}Object.defineProperty(t,"__esModule",{value:!0}),t.initOnReady=n,t.onWindowReady=o;var i=r(5),a=r(1),u=r(2),s=r(0),c=r(8),f=r(9),l=r(3),d=r(7);l.global.readyPromises=l.global.readyPromises||new i.WeakMap},function(e,t,r){"use strict";function n(e,t){return"object"===(void 0===e?"undefined":w(e))&&null!==e&&e.__type__===t}function o(e,t,r,n){var o=(0,E.uniqueID)(),i=b.global.methods.get(e);return i||(i={},b.global.methods.set(e,i)),i[o]={domain:t,method:r},{__type__:_.CONSTANTS.SERIALIZATION_TYPES.METHOD,__id__:o,__name__:n}}function i(e){return{__type__:_.CONSTANTS.SERIALIZATION_TYPES.ERROR,__message__:(0,E.stringifyError)(e)}}function a(e,t,r,n){return{__type__:_.CONSTANTS.SERIALIZATION_TYPES.PROMISE,__then__:o(e,t,function(e,t){return r.then(e,t)},n+".then")}}function u(e,t,r,n){return{__type__:_.CONSTANTS.SERIALIZATION_TYPES.ZALGO_PROMISE,__then__:o(e,t,function(e,t){return r.then(e,t)},n+".then")}}function s(e){return{__type__:_.CONSTANTS.SERIALIZATION_TYPES.REGEX,__source__:e.source}}function c(e,t,r){return(0,E.replaceObject)({obj:r},function(r,n){return"function"==typeof r?o(e,t,r,n.toString()):r instanceof Error?i(r):window.Promise&&r instanceof window.Promise?a(e,t,r,n.toString()):g.ZalgoPromise.isPromise(r)?u(e,t,r,n.toString()):(0,E.isRegex)(r)?s(r):void 0}).obj}function f(e,t,r){function n(){var n=Array.prototype.slice.call(arguments);return O.log.debug("Call foreign method",r.__name__,n),(0,S.send)(e,_.CONSTANTS.POST_MESSAGE_NAMES.METHOD,{id:r.__id__,name:r.__name__,args:n},{domain:t,timeout:1/0}).then(function(e){var t=e.data;return O.log.debug("Got foreign method result",r.__name__,t.result),t.result},function(e){throw O.log.debug("Got foreign method error",(0,E.stringifyError)(e)),e})}return n.__name__=r.__name__,n.__xdomain__=!0,n.source=e,n.origin=t,n}function l(e,t,r){return new Error(r.__message__)}function d(e,t,r){return new g.ZalgoPromise(function(n,o){return f(e,t,r.__then__)(n,o)})}function p(e,t,r){return window.Promise?new window.Promise(function(n,o){return f(e,t,r.__then__)(n,o)}):d(e,t,r)}function m(e,t,r){return new RegExp(r.__source__)}function v(e,t,r){return(0,E.replaceObject)({obj:r},function(r,o){if("object"===(void 0===r?"undefined":w(r))&&null!==r)return n(r,_.CONSTANTS.SERIALIZATION_TYPES.METHOD)?f(e,t,r):n(r,_.CONSTANTS.SERIALIZATION_TYPES.ERROR)?l(e,t,r):n(r,_.CONSTANTS.SERIALIZATION_TYPES.PROMISE)?p(e,t,r):n(r,_.CONSTANTS.SERIALIZATION_TYPES.ZALGO_PROMISE)?d(e,t,r):n(r,_.CONSTANTS.SERIALIZATION_TYPES.REGEX)?m(e,t,r):void 0}).obj}Object.defineProperty(t,"__esModule",{value:!0}),t.listenForMethods=void 0;var w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.serializeMethod=o,t.serializeMethods=c,t.deserializeMethod=f,t.deserializeError=l,t.deserializeZalgoPromise=d,t.deserializePromise=p,t.deserializeRegex=m,t.deserializeMethods=v;var y=r(5),h=r(1),g=r(2),_=r(0),E=r(7),S=r(8),O=r(9),b=r(3);b.global.methods=b.global.methods||new y.WeakMap,t.listenForMethods=(0,E.once)(function(){(0,S.on)(_.CONSTANTS.POST_MESSAGE_NAMES.METHOD,{origin:_.CONSTANTS.WILDCARD},function(e){var t=e.source,r=e.origin,n=e.data,o=b.global.methods.get(t);if(!o)throw new Error("Could not find any methods this window has privileges to call");var i=o[n.id];if(!i)throw new Error("Could not find method with id: "+n.id);if(!(0,h.matchDomain)(i.domain,r))throw new Error("Method domain "+i.domain+" does not match origin "+r);return O.log.debug("Call local method",n.name,n.args),g.ZalgoPromise.try(function(){return i.method.apply({source:t,origin:r,data:n},n.args)}).then(function(e){return{result:e,id:n.id,name:n.name}})})})},function(e,t,r){"use strict";function n(e){return s.ZalgoPromise.try(function(){if(!e.name)throw new Error("Expected options.name");var t=e.name,r=void 0,n=void 0;if("string"==typeof e.window){var o=document.getElementById(e.window);if(!o)throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be a valid element id");if("iframe"!==o.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(!o.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");r=o.contentWindow}else if(e.window instanceof HTMLIFrameElement){if("iframe"!==e.window.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(e.window&&!e.window.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");e.window&&e.window.contentWindow&&(r=e.window.contentWindow)}else r=e.window;if(!r)throw new Error("Expected options.window to be a window object, iframe, or iframe element id.");var i=r;n=e.domain||f.CONSTANTS.WILDCARD;var a=e.name+"_"+(0,d.uniqueID)();if((0,c.isWindowClosed)(i))throw new Error("Target window is closed");var u=!1,m=p.global.requestPromises.get(i);m||(m=[],p.global.requestPromises.set(i,m));var v=s.ZalgoPromise.try(function(){if((0,c.isAncestor)(window,i))return s.ZalgoPromise.resolve((0,d.onWindowReady)(i))}).then(function(){return new s.ZalgoPromise(function(r,o){var s={name:t,window:i,domain:n,respond:function(e,t){e||(u=!0,m.splice(m.indexOf(v,1))),e?o(e):r(t)}};if((0,l.addResponseListener)(a,s),(0,l.sendMessage)(i,{type:f.CONSTANTS.POST_MESSAGE_TYPE.REQUEST,hash:a,name:t,data:e.data,fireAndForget:e.fireAndForget},n).catch(o),e.fireAndForget)return r();var d=f.CONFIG.ACK_TIMEOUT,p=e.timeout||f.CONFIG.RES_TIMEOUT,w=100,y=function r(){if(!u){if((0,c.isWindowClosed)(i))return o(s.ack?new Error("Window closed for "+t+" before response"):new Error("Window closed for "+t+" before ack"));if(d-=w,p-=w,s.ack){if(p===1/0)return;w=Math.min(p,2e3)}else{if(d<=0)return o(new Error("No ack for postMessage "+t+" in "+f.CONFIG.ACK_TIMEOUT+"ms"));if(p<=0)return o(new Error("No response for postMessage "+t+" in "+(e.timeout||f.CONFIG.RES_TIMEOUT)+"ms"))}setTimeout(r,w)}};setTimeout(y,w)})});return v.catch(function(){(0,l.deleteResponseListener)(a)}),m.push(v),v})}function o(e,t,r,o){return o=o||{},o.window=e,o.name=t,o.data=r,n(o)}function i(e,t,r){var n=(0,c.getAncestor)();return n?o(n,e,t,r):new s.ZalgoPromise(function(e,t){return t(new Error("Window does not have a parent"))})}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.window)throw new Error("Expected options.window");var t=e.window;return{send:function(r,n){return o(t,r,n,e)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.send=void 0,t.request=n,t.sendToParent=i,t.client=a;var u=r(5),s=r(2),c=r(1),f=r(0),l=r(6),d=r(4),p=r(3);p.global.requestPromises=p.global.requestPromises||new u.WeakMap,t.send=o},function(e,t,r){"use strict";function n(){delete window[o.CONSTANTS.WINDOW_PROPS.POSTROBOT],window.removeEventListener("message",i.messageListener)}Object.defineProperty(t,"__esModule",{value:!0}),t.CONSTANTS=t.CONFIG=void 0;var o=r(0);Object.defineProperty(t,"CONFIG",{enumerable:!0,get:function(){return o.CONFIG}}),Object.defineProperty(t,"CONSTANTS",{enumerable:!0,get:function(){return o.CONSTANTS}}),t.disable=n;var i=r(6)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bridge=t.parent=void 0;var n=r(29);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(32);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(30);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(1);t.parent=(0,a.getAncestor)(),t.bridge=void 0},function(e,t,r){"use strict";function n(e){if(!e.name)throw new Error("Expected options.name");if(!e.handler)throw new Error("Expected options.handler");var t=e.name,r=e.window,n=e.domain,o={handler:e.handler,handleError:e.errorHandler||function(e){throw e},window:r,domain:n||d.CONSTANTS.WILDCARD,name:t},i=(0,l.addRequestListener)({name:t,win:r,domain:n},o);if(e.once){var a=o.handler;o.handler=(0,f.once)(function(){return i.cancel(),a.apply(this,arguments)})}if(o.window&&e.errorOnClose)var c=(0,f.safeInterval)(function(){r&&"object"===(void 0===r?"undefined":u(r))&&(0,s.isWindowClosed)(r)&&(c.cancel(),o.handleError(new Error("Post message target window is closed")))},50);return{cancel:function(){i.cancel()}}}function o(e,t,r){return"function"==typeof t&&(r=t,t={}),t=t||{},t.name=e,t.handler=r||t.handler,n(t)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];"function"==typeof t&&(r=t,t={}),t=t||{},r=r||t.handler;var o=t.errorHandler,i=new c.ZalgoPromise(function(n,i){t=t||{},t.name=e,t.once=!0,t.handler=function(e){if(n(e),r)return r(e)},t.errorHandler=function(e){if(i(e),o)return o(e)}}),a=n(t);return i.cancel=a.cancel,i}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{on:function(t,r){return o(t,e,r)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.on=void 0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.listen=n,t.once=i,t.listener=a;var s=r(1),c=r(2),f=r(4),l=r(6),d=r(0);t.on=o}])}()}()},function(e,t,r){e.exports=r(15),e.exports.default=e.exports},function(e,t){function r(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);e.exports=r},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t,r){function n(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var u=0;u<16;++u)t[n+u]=a[u];return t||i(a)}var o=r(18),i=r(17);e.exports=n},function(e,t,r){e.exports=r(6)}]); 